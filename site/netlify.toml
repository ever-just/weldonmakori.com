[build]
  command = "npm run build"
  publish = ".next"

[[plugins]]
  package = "@netlify/plugin-nextjs"

# Proxy PocketBase API through Netlify to avoid mixed content (HTTPS -> HTTP)
[[redirects]]
  from = "/pb/*"
  to = "http://142.93.78.220/:splat"
  status = 200
  force = true

# GoatCounter Analytics proxy
[[redirects]]
  from = "/stats/*"
  to = "http://142.93.78.220:8081/:splat"
  status = 200
  force = true

# Listmonk Newsletter proxy
[[redirects]]
  from = "/mail/*"
  to = "http://142.93.78.220:8082/:splat"
  status = 200
  force = true

# ntfy Push Notifications proxy
[[redirects]]
  from = "/notify/*"
  to = "http://142.93.78.220:8083/:splat"
  status = 200
  force = true

# Redirect weldon.lol to weldonmakori.com
[[redirects]]
  from = "https://weldon.lol/*"
  to = "https://weldonmakori.com/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://www.weldon.lol/*"
  to = "https://weldonmakori.com/:splat"
  status = 301
  force = true
